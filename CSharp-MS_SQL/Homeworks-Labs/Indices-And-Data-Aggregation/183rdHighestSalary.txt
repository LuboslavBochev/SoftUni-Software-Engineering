SELECT DepartmentID, ThirdHighestSalary FROM(
SELECT DepartmentID, Salary AS ThirdHighestSalary, DENSE_RANK() OVER(PARTITION BY DepartmentID ORDER BY Salary DESC) AS [Rank]
	FROM Employees
	GROUP BY DepartmentID, Salary) AS firt
	WHERE [Rank] = 3