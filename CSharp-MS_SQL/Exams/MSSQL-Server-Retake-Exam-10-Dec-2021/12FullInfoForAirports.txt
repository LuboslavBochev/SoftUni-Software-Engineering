CREATE PROC usp_SearchByAirportName(@airportName VARCHAR(70))
AS
BEGIN
 
		SELECT AirportName, pa.FullName, 
		CASE
		WHEN fd.TicketPrice <= 400 THEN 'Low'
		WHEN fd.TicketPrice > 400 AND fd.TicketPrice <= 1500 THEN 'Medium'
		WHEN fd.TicketPrice > 1500 THEN 'High'
		END
		AS LevelOfTickerPrice,
		ac.Manufacturer, 
		ac.Condition, [at].TypeName
		FROM Airports AS ap
		JOIN FlightDestinations AS fd ON ap.Id = fd.AirportId
		JOIN Passengers AS pa ON fd.PassengerId = pa.Id
		JOIN Aircraft AS ac ON fd.AircraftId = ac.Id
		JOIN AircraftTypes as [at] ON ac.TypeId = [at].Id
		WHERE AirportName = @airportName
		ORDER BY ac.Manufacturer, pa.FullName
END